@model DQueensFashion.Models.ProductIndexViewModel

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<style>
    .collapsible {
        background-color: #0a0c13;
        color: white;
        cursor: pointer;
        padding: 18px;
        width: 100%;
        border: none;
        text-align: left;
        outline: none;
        font-size: 15px;
        border-top: 4px solid #E97128;
    }

        .collapsible:focus {
            outline: none;
        }

        .collapsible:after {
            content: '\002B';
            color: white;
            font-weight: bold;
            float: right;
            margin-left: 5px;
        }

    .active:after {
        content: "\2212";
    }

    .content {
        padding: 0 18px;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.5s ease-out;
        background-color: #f1f1f1;
    }

    .filter-btn{
        border:none;
    }

    .filter-btn:active,
    .filter-btn:focus{
        outline:none !important;
        border:none !important;
        box-shadow: none !important;
    }

</style>


<div class="container-fluid body-content">
    <div class="row">
        <div class="col-md-4 col-12 mb-3">
            <button class="collapsible active">FILTER</button>
            <div class="content" style="max-height:100vh;padding-bottom:10px">
                <div style="padding-top:10px">
                    <div class="col-12 mb-3">
                        <div class="form-row">
                            <label class="col-3 col-form-label" for="name">Search</label>
                            <input type="text" class="form-control col-9" id="searchString" />
                        </div>
                    </div>
                    <div class="col-12 mb-3">
                        <div class="form-row">
                            <label class="col-3 col-form-label" for="name">Category</label>
                            <select class="form-control col-9" id="categoryId">
                                <option value="0">All</option>
                                @foreach (var category in Model.Categories)
                                {
                                    <option value="@category.Id" selected="@category.Selected">@category.Name</option>
                                }
                            </select>
                        </div>
                    </div>
                    <div class="col-12 mb-3">
                        <div class="form-row">
                            <label class="col-3 col-form-label" for="name">Sort by</label>
                            <select class="form-control col-9" id="sortString">
                                <option value="1">Best selling</option>
                                <option value="2">Alphabetically, A - Z</option>
                                <option value="3">Alphabetically, Z - A</option>
                                <option value="4">Price, low to high</option>
                                <option value="5">Price, high to low</option>
                                <option value="6">Date, new to old</option>
                                <option value="7">Date, old to new</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-12">
                        <button class="btn btn-block filter-btn" onclick="SearchProduct()" id="btnFilter" style="background-color:#E97128;color:white;width:100%" >FILTER <img src="~/Content/Images/filter.svg" /></button>
                    </div>
                </div>

            </div>

        </div>
        <div class="col-md-8 col-sm-12">

            @Html.Partial("_ProductsList",Model.Products)


        </div>

    </div>

</div>



<!--modals-->
<!--quick view product-->
<div class="modal fade" id="productQuickView">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Product quick view</h3>
                <a href="#" class="close" data-dismiss="modal">&times;</a>
            </div>
            <div class="modal-body" id="productQuickViewBody">


            </div>


        </div>

    </div>

</div>

<script>

    var _searchString = document.getElementById("searchString");
    var _sortString = document.getElementById("sortString");
    var _categoryId = document.getElementById("categoryId");

    function SearchProduct() {
        $.ajax({
            url: '/product/searchproduct',
            dataType: "html",
            data: { searchString: _searchString.value, sortString: _sortString.value, categoryId: _categoryId.value },
            success: function (result) {
                $("#productsList").html(result);
            },
            error: function (xhr, status, error) {
                alert("Error");
            }
        });

    }

    function ProductPagination(pageNumber) {
        $.ajax({
            url: '/product/ProductPagination',
            dataType: "html",
            data: { searchString: _searchString.value, sortString: _sortString.value, categoryId: _categoryId.value, pageNumber: pageNumber },
            success: function (result) {
                $("#productsList").html(result);
                $(window).scrollTop(0);
            },
            error: function (xhr, status, error) {
                alert("Error");
            }
        });
    }

    function productQuickView(productId) {
        var url = "/Product/ProductQuickView/" + productId;

        $("#productQuickViewBody").load(url, function () {
            $("#productQuickView").modal("show");

        })
    }


    var coll = document.getElementsByClassName("collapsible");
    var i;

    for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function () {
            this.classList.toggle("active");
            var content = this.nextElementSibling;
            if (content.style.maxHeight) {
                content.style.maxHeight = null;
            } else {
                content.style.maxHeight = content.scrollHeight + "px";
            }
        });
    }
</script>

