@model DQueensFashion.Models.ProductDetailsViewModel
@using DQueensFashion.Utilities
@{
    ViewBag.Title =Model.Product.Name;
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@*<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">*@
<style>
    .checked {
        color: orange;
    }

    .orButton {
        width: 100%;
        text-align: center;
        border-bottom: 1px solid #000;
        line-height: 0.1em;
        margin: 10px 0 20px;
    }

        .orButton span {
            background: #F4F6F6;
            padding: 0 10px;
        }

    .product-details {
        margin: 0px;
    }

    .carousel-item {
        height: 350px;
    }

    .carousel-indicators li {
        width: 10px;
        height: 10px;
        border-radius: 100%;
        background-color: #df7204;
    }

    .carousel-indicators {
        bottom: -50px;
    }


    .product-details-title {
        white-space: normal;
        font-weight: 400;
        font-size: 30px;
        color: #29303b;
        margin-bottom: 0px;
    }

    .product-details-detail {
        white-space: normal;
        font-size: 15px;
        font-weight:500;
        margin: 0;
        padding: 3px;
    }

        .product-details-detail > span {
            white-space: normal;
            font-size: 15px;
            font-weight: 400;
        }


    .product-details-initial-price {
        font-size: 20px;
        line-height: 15px;
        color: #75757a;
        text-decoration: line-through;
        padding: 3px;
    }

    .product-details-price {
        font-size: 30px;
        font-weight: 700;
        padding: 3px;
        color: red;
    }
</style>

<div class="container body-content">
    <div class="row">
        <div class="col-md-8 mt-3">
            <div class="row">
                <div class="col-md-6">

                    <div id="productCarousel" class="carousel slide mb-3" data-ride="carousel" data-interval="false">
                        <ol class="carousel-indicators">
                            <li data-target="#productCarousel" data-slide-to="0" class="active"></li>
                            @{
                                int productCount = 1;
                                foreach (var productImage in Model.Product.OtherImagePaths)
                                {
                                    <li data-target="#productCarousel" data-slide-to="@productCount"></li>
                                    productCount++;
                                }
                            }

                        </ol>
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <img class="" style="width:100%;height:400px" src="@Url.Content(Model.Product.MainImage)" alt="First slide">
                            </div>
                            @{
                                foreach (var productImage in Model.Product.OtherImagePaths)
                                {
                                    <div class="carousel-item">
                                        <img class="" style="width:100%;height:500px" src="@Url.Content(productImage)" alt="Second slide">
                                    </div>
                                }
                            }

                        </div>

                    </div>
                </div>

                <div class="col-md-6">
                    <div class="row">
                        <div class="col-12">
                            <h1 class="product-details-title">@Model.Product.Name</h1>
                            <div class="">
                                @Html.Partial("_averageRating", Model.Product.Rating)
                            </div>
                        </div>
                    </div>
                    <hr class="mt-1 mb-1" />
                    <div class="row">
                        <div class="col-12">
                            <div class="product-details-detail"><span>CATEGORY:</span> @Model.Product.Category</div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="product-details-detail"><span>PRODUCT AVAILABILITY:</span>@Model.Product.Quantity</div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 mb-1">
                            <div class="product-details-price">$@Model.Product.SubTotal</div>
                            @if (Model.Product.Discount > 0)
                            {
                                <span class="product-details-initial-price">$@Model.Product.Price</span>
                                <span style="background-color:#df7204;color:white;padding:5px">-@Model.Product.Discount%</span>
                            }

                        </div>
                    </div>
                    <div class="mt-1 mb-1">
                        <div class="wishlist-button" onclick="AddToWishList(@Model.Product.Id)">
                            <div href="#">Add to wishlist</div>
                        </div>
                    </div>
                    <div class="mt-1">
                        @{
                            if (Model.Product.CategoryId == AppConstant.CustomMadeCategoryId 
                                || Model.Product.CategoryId==AppConstant.ReadyMadeCategoryId)
                            {
                                <div class="cart" onclick="AddToCartCustomReadyMade(@Model.Product.Id)">
                                    <div href="#">Add to cart</div>
                                </div>
                            }
                            else
                            {
                                <div class="cart" onclick="AddToCart(@Model.Product.Id)">
                                    <div href="#">Add to cart</div>
                                </div>
                            }
                        }
                    </div>
             
                </div>

            </div>

        </div>
        <div class="col-md-4 mt-3">
            <div class="card">
                <div class="card-header" style="background-color:white">
                    <div style="font-weight:500;font-size:15px">DELIVERY AND RETURNS</div>
                </div>
                <div class="card-body p-3">
                    <table>
                        <tbody>
                            <tr class="m-2">
                                <td style="width:50px;vertical-align:top">
                                    <img src="~/Content/Images/delivery-truck.svg" />
                                </td>
                                <td>
                                    <h6>Delivery information</h6>
                                    <div style="font-weight:300;font-size:15px">
                                        Normally delivered between @Model.Product.DeliveryDaysDuration@{ 
                                            if (Model.Product.DeliveryDaysDuration < 2)
                                            {
                                                <span> Day.</span>
                                            }
                                            else
                                            {
                                                <span> Days.</span>
                                            }
                                        }
                                        Please check exact dates in the Checkout page.
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="width:50px;vertical-align:top">
                                    <img src="~/Content/Images/corner-down-left.svg" />
                                </td>
                                <td>
                                    <h6>Return policy</h6>
                                    <div style="font-weight:300;font-size:15px">
                                        Free return within 7 days for eligible items. See more
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="width:50px;vertical-align:top">
                                    <img src="~/Content/Images/shield.svg" />
                                </td>
                                <td>
                                    <h6>Waranty</h6>
                                    <div style="font-weight:300;font-size:15px">
                                        6 months
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
               
                </div>
            </div>
        </div>
    </div>





    <div id="review-scroll-to"></div>
    <div class="row mt-5">
        <div class="col-12">
            <div class="section_header" style="margin-bottom:1px">
                <div class="section_header_text">
                    <h5 style="margin-top: 15px;">DESCRIPTION</h5>
                </div>
            </div>
            <div style="text-justify:inter-word;text-align:justify">
                @Html.Raw(Model.Product.Description.Replace(Environment.NewLine, "<br/>"))
            </div>

        </div>
    </div>

    <div class="row mt-5">
        <div class="col-12">
            <div class="section_header" style="margin-bottom:1px">
                <div class="section_header_text">
                    <h5 style="margin-top: 15px;display:inline">REVIEWS (@Model.Product.Rating.TotalReviewCount)</h5>
                </div>
                <span>
                    <select class="form-control-sm" id="sort-review" onchange="SortReview(@Model.Product.Id)">
                        <option value="0">Sort by</option>
                        <option value="1">Most recent</option>
                        <option value="2">Least recent</option>
                        <option value="3">Highest rating</option>
                        <option value="4">Lowest rating</option>
                    </select>
                </span>
            </div>
            @Html.Partial("_productReview", Model.Product.Reviews)
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <div class="section_header" style="margin-bottom:1px">
                <div class="section_header_text">
                    <h5 style="margin-top: 15px;">RELATED PRODUCTS</h5>
                </div>
            </div>

        </div>
    </div>
    <div class="row mt-1">

        @{
            foreach (var product in Model.RelatedProducts)
            {
                <div class="col-lg-3 col-6">
                    @Html.Partial("~/Views/Product/_productCard.cshtml", product)
                </div>
            }
        }
        <div class="col-12 mb-1">
            <button class="btn" style="color: white;background-color:#df7204;" onclick="ShopByCategory(@Model.Product.CategoryId)">View more</button>
        </div>

    </div>
</div>


<script>
    var productQuantity = document.getElementById("productQuantity");
    var quantity = document.getElementById("quantity");
    var quantityValidationError = document.getElementById("quantityValidationError");
    var productImage = document.getElementById("productDisplayImage");
    var _sortReview = document.getElementById("sort-review");

    function addToCartFromProductDetails(productId) {
        AddToCart(productId, quantity.value);
    }


    function ReviewPagination(productId, pageNumber) {
        document.getElementById("loading-effect").style.display = "block";

        $.ajax({
            url: '/product/ReviewPagination',
            dataType: "html",
            data: { productId: productId, pageNumber: pageNumber, sortId: _sortReview.value },
            success: function (result) {
                $("#reviewList").html(result);
                document.getElementById("review-scroll-to").scrollIntoView();
            },
            error: function (xhr, status, error) {
                alertify.error("Error");
                document.getElementById("loading-effect").style.display = "none";
            }
        });
    }

    function SortReview(productId) {
        document.getElementById("loading-effect").style.display = "block";

        if (_sortReview.value > 0) {
            $.ajax({
                url: '/product/SortReview',
                dataType: "html",
                data: { productId: productId, sortId: _sortReview.value },
                success: function (result) {
                    $("#reviewList").html(result);
                },
                error: function (xhr, status, error) {
                    alertify.error("Error");
                document.getElementById("loading-effect").style.display = "none";
                }
            });
        }
    }

</script>

